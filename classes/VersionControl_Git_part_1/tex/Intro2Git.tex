\documentclass[12pt,letterpaper]{article}
\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

% the above packages are the "base"

\usepackage{graphicx}

\usepackage{hyperref} % enable links within pdf
\hypersetup{colorlinks = true, linkcolor = black, urlcolor = blue}

\usepackage{pdfpages} % enable insertion of another pdf
\usepackage{float} % for [!h] and [H] forcing of figure placement

% For making a multi-page box
\usepackage[most]{tcolorbox}


\setcounter{secnumdepth}{0}  % don't number sections (stars not needed)


\author{}
\title{Getting started with \texttt{Git} \& \texttt{GitHub}}
\date{}

\begin{document}
\maketitle

\tableofcontents

\pagebreak


\section{What is version control?}
Version control software allows you to save and provide meta-information on any and all changes you make to a set of files and directories.
It allows you to more easily document changes and the evolution of your files, 
find and correct bugs that have crept into your code, 
and revert back to old versions when needed.
By using version control you'll know what, 
when and (hopefully) why changes were made.
If you're using the software collaboratively, 
you'll also know by whom changes were made.
Backing-up is virtually implicit when you also use a networked (off-site) server as a host for your repository.

We'll be using \texttt{Git} as our version control software.
There are others out there (e.g., \texttt{Subversion}).
We'll be using \texttt{GitHub} as our host.
There are others out there (e.g., \texttt{Bitbucket}).

\section{Git}
\texttt{Git} was developed by Linus Torvalds (the ``Linu'' in Linux).
Most of its features are accessed by command-line
\unskip
\footnote{
	Except when using the ``Git-light'' that comes with \texttt{GitHub Desktop}!}
and are intended for large-scale collaborative programming and software development purposes.
Of course, we'll be using \texttt{Git} for much smaller, specific projects, thus we 
won't bother with many of these features.
We'll also interact with \texttt{Git} using GUIs (graphical user interfaces, e.g., \texttt{R-Studio}, \texttt{Sourcetree}, \texttt{GitHub Desktop}) rather than command-line.


\section{GitHub}
\texttt{Git} stores a complete copy of the project on your local machine, 
including all its history and versions; 
no centralized server is necessary.
However, if you want to collaborate with others, 
have multiple computers on which you'd like to work, 
or want to create true back-ups of your project, 
then you'll also want to use a server on which to host your repository.
Fortunately, there are a number of free providers.

For \texttt{Git}, 
the primary options are \texttt{GitHub} and \texttt{Bitbucket}.
The former is more developed (more bells and whistles), 
is currently more widely used, 
and is perhaps a little easier to work with.
At the time of writing,
the two don't differ all that much except in one regard:  
the number of free versus public repositories.
While \texttt{GitHub} has a limit on the number of private repositories, 
\texttt{Bitbucket} has a limit on the number of collaborative projects
(having more than 5 collaborators).
(There are perks regarding the number of repositories you can have if you sign up using an academic email address.  
See \url{https://help.github.com/en/articles/applying-for-an-educator-or-researcher-discount}.)



\section{Installing and configuring Git}

If you're using \texttt{GitHub Desktop}, then you're already done;
a "light" version of \texttt{Git} is bundled into the app.

If you'd like to install the full version of \texttt{Git} to use per command-line or with a different GUI, then see the \texttt{README.md} of our very first class.  
After installing the full version there's a little (minimum of) command-line configuration to perform:
On a Mac, open a \texttt{Terminal} window and type in the following:

\noindent
     \texttt{\$ git config --global user.name "Mark Novak"}\\
     \texttt{\$ git config --global user.email "Mark.Novak@oregonstate.edu"}

\noindent
Some of you might want to set up a default text editor with which to open files,
for example:

\noindent
	\texttt{\$ git config --global core.editor code}

\noindent
(replacing \texttt{code} (which stands for Virtual Studio Code) for the call to your editor).

You can check to ensure that these commands went through and see what other things you might want to configure using

\noindent
\texttt{\$ git config --list}

\noindent
For more, or if you're using Windows, see\\
\begin{footnotesize}
\url{https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup}
\end{footnotesize}




\section{Repository setup}
There are command-line methods for doing everything we're going to do below.
Indeed, command-line is the default way to interact with \texttt{Git}.
\unskip\footnote{See last page for a cheat sheet.}
Instead, we're mostly going to make use of the tools made available through 
\texttt{GitHub}, 
starting with the very first step of initiating a repository and 
getting some minimal information associated with it.
That is, rather than creating and setting up a repository on our computer by 
command-line or your Git GUI and then connecting it to \texttt{GitHub}, 
we'll create and set up the repository on \texttt{GitHub} and then clone it to our local folder of projects.

Simply login to your \texttt{GitHub} account, 
click on ``New Repository'', 
and follow the instructions.
\unskip
\footnote{
	When doing so, be sure you're in your own user 
environment and not inside our Analytical Workflows organization.}
These should include options for private vs. public
(the latter is preferred for this class
\unskip
\footnote{
	If at all possible, please pick public (for this class) and switch to private afterwards.  
	Otherwise, please add me as a collaborator so I can see your repo.}), 
initializing with a \texttt{README.md} file 
(which you \emph{should} do), 
as well as a \texttt{.gitignore} file 
(which you \emph{should} also do, 
choosing your planned programmaing environment
(e.g., \texttt{R}) from the dropdown menu).
You don't need to initialize with a license 
(MIT is a common choice, if you would like to).

\begin{tcolorbox}[breakable, enhanced, before upper={\parindent15pt}]
	\noindent
	The \texttt{README.md} file in the main repo folder is the first file that anyone will see when they inspect your repository.
	At minimum, it should give an overview of what the project is about and what the various parts of the project structure are.
	The initialized file will simply contain the repository's name as a header.
	We will learn to use Markdown to write and edit \texttt{README.md} files later in the course, 
	so for now just leave it as is.
\end{tcolorbox}

\begin{tcolorbox}[breakable, enhanced, before upper={\parindent15pt}]
	\noindent
	The \texttt{.gitignore} file contains a list of all the files that you want \texttt{Git} to ignore
	(i.e. not monitor for changes).
	Selecting \texttt{R} from the dropdown list will auto-populate a bunch of it for you, 
	including files like the \texttt{.Rhistory} file that save session information and the like.
	You can add additional file and folder names to the \texttt{.gitignore} file as well.
	You might want to do this to keep your data or manuscript in a different repository but still in the same project folder 
	(see back to our discussion of structuring projects).
	Later in the course,
	we'll add the extensions for all the temporary files that \LaTeX\ produces when compiling.
\end{tcolorbox}

You should now see a new webpage -- your Repository page -- that shows you what's in your repository.
For now it contains only your \texttt{.gitignore} and \texttt{README.md} files, 
the latter of which has its contents displayed.
\unskip
\footnote{
	There will actually be other files in the folder when you clone it to your local computer as well, 
	but they're hidden by default.  
	They're files that \texttt{Git} uses for managing the repository.}
As I said earlier, there are a lot of bells-and-whistles at your fingertips here.
We'll ignore them for now, but feel free to explore!
You \emph{could} start dragging-in directories and files into your browser view 
to add them to your repository, 
but we're \emph{not} going to do that.
Instead, we're going to \texttt{clone} this repository to our local machine, 
then add our various project sub-folders to it
(e.g., \texttt{code}, \texttt{data}, and \texttt{results}), 
and go from there.
\unskip
\footnote{
	Note that empty folders will not be monitored by \texttt{Git}; 
	they need to contain something.
	You can (and should) add a folder-specific README.md to explain its contents!}

To clone the repository, 
click the green \texttt{Clone} button and copy the provided URL.
There's a few ways to clone your repository to your local machine.
Your preferred method depends on how you're likely to interface with \texttt{Git}.
You could:
\begin{enumerate}
	\item use command-line to clone.  
	Open \texttt{Terminal}, \texttt{cd} into your \texttt{Projects} master folder, 
	then type \texttt{git clone} followed by the URL you just copied;
	\item use a visual \texttt{Git} GUI client to clone the repo;
\end{enumerate}
or, if you're primarily going to be using this repository to keep track of an \texttt{R}-based project using \texttt{R-Studio}:
\begin{enumerate}
  \setcounter{enumi}{2}
	\item set up a ``project'' within \texttt{R-Studio} first and provide it with the URL during setup.  It'll then clone the repo for you.
\end{enumerate}

\section{R-Studio and Git GUIs}
I use \texttt{Git} for both \texttt{R} and non-\texttt{R} (e.g.,  \texttt{Mathematica})-based projects and for writing manuscripts.
\texttt{R-Studio} has integrated  \texttt{Git} functionality, 
so I use a visual \texttt{Git} GUI client
(e.g., \texttt{Sourcetree}, \texttt{GitHub Desktop}) 
for the other projects because I haven't yet bothered to memorize the \texttt{Git} command-line commands.
Since most of you are probably using \texttt{R}, 
it's probably worthwhile to start off by using \texttt{R-Studio}'s \texttt{Git} integration feature.
(Note, however, that \texttt{R-Studio} isn't able to do some useful things which 
we'll cover later.  
Therefore you'll still benefit from using a \texttt{Git} GUI or learning the commands.)

You'll first need to tell \texttt{R-Studio} that you have \texttt{Git} installed, 
so go to its \textit{Preferences}, 
select \texttt{Git/SVN},
and fill in the details: 
either click on the \textit{Help} link 
or go to \url{http://r-pkgs.had.co.nz/git.html} to see what to do.

After that one-time initial setup,
create your ``project'' within  \texttt{R-Studio} by selecting \textit{``New Project''}.
Select \texttt{Version Control: Checkout a project from...repository}, 
select \texttt{Git}, 
and fill in the details including the URL you got from \texttt{GitHub}.
Place your repository wherever you plan to keep all your project folders 
(see back to our discussion of structuring projects).
\texttt{R-Studio} will ``restart'' and then you'll be in your project
(as evidenced by its name appearing in the top-right of the interface).
Clicking on the \texttt{Files} tab will show you what's in the repository/folder
(which at minimum should now be:
\texttt{README.md} and \texttt{.gitignore} and a newly created \texttt{.Rproj} file).

You may now create (or move in) all your project sub-folders.




\section{The Git workflow}
Before proceeding, jump over and do the \textbf{required reading:}\\
\url{https://git-scm.com/book/en/v2/Getting-Started-What-is-Git%3F}.\\
Then come back here.

In a nutshell, 
files exist in one of four states of a \texttt{Git} life-cycle: 
\emph{untracked}, \emph{staged}, \emph{unmodified}, or \emph{modified}
(see Fig. \ref{fig:lifecycle}).
The standard workflow is thus:
\begin{enumerate}
	\item Add or modify some files;
	\item Stage the new or modified files;
	\item Commit the changed files
	(moving them from the Staging Area to the ``memory'' of the repository);
	\item Repeat.
\end{enumerate}

\begin{figure}
	\includegraphics[width=\linewidth]{figs/lifecycle}
	\caption{The \texttt{Git} life-cycle.}
	\label{fig:lifecycle}
\end{figure}

Your motto for using \texttt{Git} should be ``\emph{commit early, commit often}''.
Almost every time you add or remove something from your project
(i.e. a file or a chunk of code), 
you want to commit those changes.
Ideally, each commit should correspond to a ``logical unit'', 
one that you are able to describe in a few words
(e.g., ``Add function to perform resampling'').
Choosing when to commit is quite important, 
especially when you're debugging code.
For example, if you've discovered your code has two bugs, 
then you should commit each one of the fixes seperately, not together.
That way you can undo either fix independently if, for example, 
you messed up in one of your fixes or your fix created a different bug somewhere else in your code.
\unskip
\footnote{
	We'll talk about using ``branches'' to reduce the incidence of problems down the road.}

\texttt{Git} GUIs provide visual interfaces for viewing your files, 
staging area, and commits.
Within \texttt{R-Studio}
(assuming you have your \texttt{R-Studio} project opened), 
looking at the \texttt{Git} tab will show you a list of all the files that have been changed, removed, or added to the project since the last time you committed.
Clicking on the check-boxes associated with each file will add them to the staging area.
Clicking on \texttt{Diff} or \texttt{Commit} will open up a new interface (the staging area).
In the top-left corner you'll see a list of the staged files.
Selecting one of the files will bring its contents up in the window below which highlights the text that has been added (in green) and removed (in red).
Select all the files you want to commit, stage them, 
add a commit message to the top-right window, and commit.
You've now updated your local respository.
Clicking on \texttt{History} (top-left) will show you all your past commits.
  
Every commit message must at minimum have a ``subject line''.
That subject line is often the only thing in your commit message.  
However, you can also write a whole lot more if you'd like, paragraphs even, 
by adding a blank second line between the subject line and the rest of your 
message.  
How to write good commit message subject lines is a topic unto itself
(Fig.~\ref{fig:commit_messages})! 
\unskip
\footnote{
	For a great post on writing commit messages, see 
	\url{https://chris.beams.io/posts/git-commit/}.} 
For now, the only things we'll say are:
\begin{enumerate}
	\item a properly-formed \texttt{Git} commit subject line should always 
	complete the sentence:  
``If applied, this commit will \emph{your subject line here...}'';
	\item capitalize the first word; and
	\item don't use a period at the end of the sentence.	
\end{enumerate} 


\begin{tcolorbox}[breakable, enhanced, before upper={\parindent15pt}]
\begin{center}
\textbf{\emph{Commit early, commit often}\\
		with concise and informative commit messages}
\end{center}
\end{tcolorbox}


\subsection{Syncing with \texttt{GitHub}}

Though not part of the \texttt{Git} workflow itself
(since \texttt{Git} is only doing things locally),
the final thing to do is to \texttt{Push} 
your commit(s) to \texttt{GitHub}.
You certainly do \textit{not} need to do this after each commit!

\texttt{Pull} does the opposite of \texttt{Push}: 
bringing commits that have been pushed to \texttt{GitHub}
to your local machine.
This will happen if you're working collaboratively or on multiple machines.
\unskip
\footnote{You can also use \texttt{Fetch} to see if new commits have been pushed to \texttt{GitHub} before actually pulling them to your machine.}
To reduce the likelihood of creating conflicts,
\emph{always} pull before you start making edits!
There are of course ways of dealing with conflicts and merging files
(that will arise if collaborator(s) are working on the same file, for example), 
but pulling first will do a lot to avoid unneccessary hassle.
\unskip
\footnote{We'll learn about merging and conflict resolution later in the course.}

\begin{tcolorbox}[breakable, enhanced, before upper={\parindent15pt}]
		\begin{center}
			\textbf{\emph{Pull, create/edit, stage, commit, push, repeat}}
		\end{center}
\end{tcolorbox}

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{figs/xkcd_git_commit}
	\caption{Don't let this happen!  (source: \url{http://xkcd.com/1296/})}
	\label{fig:commit_messages}
\end{figure}

\clearpage

\includepdf{../reference/git_cheat_sheet.pdf}

\end{document}
